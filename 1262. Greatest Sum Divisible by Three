class Solution {
    public int maxSumDivThree(int[] nums) {
        int sum = 0;
        int min1 = Integer.MAX_VALUE , min2 = Integer.MAX_VALUE;
        int m1 = Integer.MAX_VALUE, m2 = Integer.MAX_VALUE;

        for(int x : nums){
            sum += x;
            int r = x % 3;
            if(r == 1){
                if(x < min1){
                    min2 = min1;
                    min1 = x;
                }else if(x < min2){
                    min2 = x;
                }
            } else if(r == 2){
                if(x < m1){
                    m2 = m1;
                    m1 = x;
                }else if(x < m2){
                    m2 = x;
                }
            }
        }

        int r = sum % 3;
        if(r == 0) return sum;

        int remove = Integer.MAX_VALUE;
        if(r == 1){
            if(min1 != Integer.MAX_VALUE) remove = Math.min(remove, min1);
            if(m1 != Integer.MAX_VALUE && m2 != Integer.MAX_VALUE) remove = Math.min(remove, m1 + m2);
        } else { // r == 2
            if(m1 != Integer.MAX_VALUE) remove = Math.min(remove, m1);
            if(min1 != Integer.MAX_VALUE && min2 != Integer.MAX_VALUE) remove = Math.min(remove, min1 + min2);
        }

        return remove == Integer.MAX_VALUE ? 0 : sum - remove;
    }
}
